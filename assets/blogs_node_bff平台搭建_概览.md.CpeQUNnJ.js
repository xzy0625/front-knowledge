import{_ as e,c as l,o as d,at as a}from"./chunks/framework.BvgWjPB6.js";const g=JSON.parse('{"title":"bff平台搭建","description":"","frontmatter":{},"headers":[],"relativePath":"blogs/node/bff平台搭建/概览.md","filePath":"blogs/node/bff平台搭建/概览.md","lastUpdated":1738931418000}'),i={name:"blogs/node/bff平台搭建/概览.md"};function r(n,t,s,o,f,x){return d(),l("div",null,t[0]||(t[0]=[a('<h1 id="bff平台搭建" tabindex="-1">bff平台搭建 <a class="header-anchor" href="#bff平台搭建" aria-label="Permalink to &quot;bff平台搭建&quot;">​</a></h1><h2 id="cos" tabindex="-1">cos <a class="header-anchor" href="#cos" aria-label="Permalink to &quot;cos&quot;">​</a></h2><p>cos分路径存储。通过 应用 / 用户id / 文件名</p><p>corn定时脚本，定时删除14天前的文件和db数据</p><h2 id="配置" tabindex="-1">配置 <a class="header-anchor" href="#配置" aria-label="Permalink to &quot;配置&quot;">​</a></h2><p>使用七彩石作为配置，不同环境拉取不同的配置。例如数据库密码/账号等就是从配置中拉取。</p><h2 id="路径" tabindex="-1">路径 <a class="header-anchor" href="#路径" aria-label="Permalink to &quot;路径&quot;">​</a></h2><p>分为两个路径，一个是公司内部用，一个是外部用。是同一个服务，但是是通过不同的域名 + 路径访问的。一个是外部域名，一个是内部域名</p><h2 id="部署" tabindex="-1">部署 <a class="header-anchor" href="#部署" aria-label="Permalink to &quot;部署&quot;">​</a></h2><ol><li>流水线CI/CD拉取代码，打包后生成打包产物</li><li>将打包打包成镜像，并把镜像放到镜像仓库。</li><li>将镜像发布到腾讯云，并且会自动运行镜像，然后就会执行<code>npm run</code>命令。</li><li>新增一个名字服务，将机器<code>ip</code>添加到名字服务里面</li><li>通过统一接入服务，上述名字服务接入到指定域名的路径</li></ol><h3 id="顺便提一下前端部署" tabindex="-1">顺便提一下前端部署 <a class="header-anchor" href="#顺便提一下前端部署" aria-label="Permalink to &quot;顺便提一下前端部署&quot;">​</a></h3><ol><li>流水线CI/CD拉取代码，打包后生成打包产物。js/css上传到CDN</li><li>将打包打包成一个带有Nginx环境的镜像，使用的是Nginx+Node镜像(FROM mirrors.tencent.com/ams_public/tlinux2.2-ams-nodejs:16.13.1)。并把镜像放到镜像仓库。</li><li>将镜像发布到腾讯云，并且会自动运行镜像，然后启动<code>Nginx</code>，使用项目中的<code>nginx</code>文件进行代理。</li><li>新增一个名字服务，将机器<code>ip</code>添加到名字服务里面</li><li>通过统一接入服务，上述名字服务接入到指定域名的路径</li></ol><h2 id="ias" tabindex="-1">IAS <a class="header-anchor" href="#ias" aria-label="Permalink to &quot;IAS&quot;">​</a></h2><p>IAS 一站式智能接入服务，不仅包括基础的 http/https 转发和负载均衡的原子能力，还包括多集群智能调度和网络传输协议优化等</p><p>目的是为业务/客户提供&quot;一键式&quot;的整套接入能力、更可靠服务能力和更好的网络接入性能</p><p>作为通用接入层给用户提供安全快捷的流量分发服务，访问流量经由 IAS可以自动转发到IDC、云上TKE等，扩展系统的服务能力并消除单点故障.</p><p>整合了安全扫描、安全防护、容灾、调度等能力 为用户提供便捷的业务流量接入体验</p><table tabindex="0"><thead><tr><th style="text-align:left;"><strong>能力</strong></th><th style="text-align:left;"><strong>HTTP协议(CLB)</strong></th><th></th></tr></thead><tbody><tr><td style="text-align:left;">转发能力</td><td style="text-align:left;">柔性</td><td></td></tr><tr><td style="text-align:left;">路由灰度</td><td style="text-align:left;">可通过自定义配置实现按条件灰度</td><td></td></tr><tr><td style="text-align:left;">0RTT</td><td style="text-align:left;">QUIC下支持</td><td></td></tr><tr><td style="text-align:left;">多通道</td><td style="text-align:left;">QUIC下支持</td><td></td></tr><tr><td style="text-align:left;">长连接</td><td style="text-align:left;">HTTP2、 QUIC</td><td></td></tr><tr><td style="text-align:left;">后端协议支持</td><td style="text-align:left;">HTTP/HTTPS</td><td></td></tr><tr><td style="text-align:left;">支持名字服务</td><td style="text-align:left;">北极星、CL5、TAF、IP列表</td><td></td></tr><tr><td style="text-align:left;">安全</td><td style="text-align:left;">支持TLS1.0(不建议)、TLS1.1(不建议)、TLS1.2、TLS1.3</td><td></td></tr><tr><td style="text-align:left;">证书托管 - 证书自动续期</td><td style="text-align:left;"></td><td></td></tr><tr><td style="text-align:left;">WAF能力:自动接入洞犀安全扫描、门神安全防护</td><td style="text-align:left;"></td><td></td></tr><tr><td style="text-align:left;">白名单功能：IP白名单</td><td style="text-align:left;"></td><td></td></tr><tr><td style="text-align:left;">合规:备案提醒、特殊地区封禁</td><td style="text-align:left;"></td><td></td></tr><tr><td style="text-align:left;">防突发:限速或者迁移到一个泄洪集群，该集群与其他业务隔离</td><td style="text-align:left;"></td><td></td></tr><tr><td style="text-align:left;">容灾</td><td style="text-align:left;">多地部署，默认：华东（上海/南京）、华南（广州/深圳）、华北（天津/北京）、香港/新加坡等，另外支持EC机房（二线城市机房，价格便宜，就近接入）</td><td></td></tr><tr><td style="text-align:left;">自动屏蔽异常VIP</td><td style="text-align:left;"></td><td></td></tr><tr><td style="text-align:left;">外网IP调度</td><td style="text-align:left;">就近调度</td><td></td></tr><tr><td style="text-align:left;">自动发现和屏蔽异常VIP</td><td style="text-align:left;"></td><td></td></tr><tr><td style="text-align:left;">监控</td><td style="text-align:left;">1）IAS域名-指标监控：维度:域名、二级路径、主被调、返回码等指标:各状态码、连接成功率等2）IAS域名拨测监控 - 证书拨测</td><td></td></tr></tbody></table><h2 id="北极星" tabindex="-1">北极星 <a class="header-anchor" href="#北极星" aria-label="Permalink to &quot;北极星&quot;">​</a></h2><p>北极星是统一名字服务组件，名字服务用于解决远程调用（RPC）的服务注册发现、动态路由、负载均衡和容错问题，在分布式和微服务架构中至关重要。</p><ul><li>由于不同系统上的数据不通，不同系统上的服务难以互相调用</li><li>不同系统的功能特性不一致，功能特性和易用性落后于业界水平</li></ul>',21)]))}const c=e(i,[["render",r]]);export{g as __pageData,c as default};
